<!DOCTYPE html>
<html>
<head>
  <meta charset="utf-8">
  <meta name="description"
        content="d1: Scaling Reasoning in Diffusion Large Language Models via Reinforcement Learning">
  <meta name="keywords" content="CLIP, mBART, NMT">
  <meta name="viewport" content="width=device-width, initial-scale=1">
  <title>d1: Scaling Reasoning in Diffusion Large Language Models via Reinforcement Learning</title>

  <script>
    window.dataLayer = window.dataLayer || [];

    function gtag() {
      dataLayer.push(arguments);
    }

    gtag('js', new Date());

    gtag('config', 'G-PYVRSFMDRL');
  </script>

  <link href="https://fonts.googleapis.com/css?family=Google+Sans|Noto+Sans|Castoro"
        rel="stylesheet">

  <link rel="stylesheet" href="./static/css/bulma.min.css">
  <link rel="stylesheet" href="./static/css/bulma-carousel.min.css">
  <link rel="stylesheet" href="./static/css/bulma-slider.min.css">
  <link rel="stylesheet" href="./static/css/fontawesome.all.min.css">
  <link rel="stylesheet"
        href="https://cdn.jsdelivr.net/gh/jpswalsh/academicons@1/css/academicons.min.css">
  <link rel="stylesheet" href="./static/css/index.css">

  <script src="https://ajax.googleapis.com/ajax/libs/jquery/3.5.1/jquery.min.js"></script>
  <script defer src="./static/js/fontawesome.all.min.js"></script>
  <script src="./static/js/bulma-carousel.min.js"></script>
  <script src="./static/js/bulma-slider.min.js"></script>
  <script src="./static/js/index.js"></script>
</head>
<body>

<nav class="navbar" role="navigation" aria-label="main navigation">
  <div class="navbar-brand">
    <a role="button" class="navbar-burger" aria-label="menu" aria-expanded="false">
      <span aria-hidden="true"></span>
      <span aria-hidden="true"></span>
      <span aria-hidden="true"></span>
    </a>
  </div>
  <div class="navbar-menu">
    <div class="navbar-start" style="flex-grow: 1; justify-content: center;">
      <a class="navbar-item" href="https://devaansh100.github.io">
      <span class="icon">
          <i class="fas fa-home"></i>
      </span>
      </a>
  </div>
</nav>


<section class="hero">
  <div class="hero-body">
    <div class="container is-max-desktop">
      <div class="columns is-centered">
        <div class="column has-text-centered">
          <h1 class="title is-1 publication-title">d1: Scaling Reasoning in Diffusion Large Language Models via Reinforcement Learning</h1>
          <div class="is-size-5 publication-authors">
            <span class="author-block">
              <a href="https://siyan-zhao.github.io">Siyan Zhao*</a><sup>1</sup>,</span>
            <span class="author-block">
              <a href="https://devaansh100.github.io">Devaansh Gupta*</a><sup>1</sup>,</span>
            <span class="author-block">
              <a href="https://enosair.github.io">Qinqing Zheng</a><sup>2</sup>,
            </span>
            <span class="author-block">
              <a href="https://aditya-grover.github.io">Aditya Grover</a><sup>1</sup>
            </span>
          </div>

          <div class="is-size-5 publication-authors">
            <span class="author-block"><sup>1</sup>University of California, Los Angeles</span>
            <span class="author-block"><sup>2</sup>Meta AI</span>
          </div>
          <!-- <div class="is-size-6 publication-authors">
            <span class="author-block">Published in International Conference of Computer Vision, 2023</span>
          </div> -->

          <div class="column has-text-centered">
            <div class="publication-links">
              <!-- PDF Link. -->
<!--               <span class="link-block">
                <a href=""
                   class="external-link button is-normal is-rounded is-dark">
                  <span class="icon">
                      <i class="fas fa-file-pdf"></i>
                  </span>
                  <span>Paper</span>
                </a>
              </span>
 -->              <span class="link-block">
                <a href=""
                   class="external-link button is-normal is-rounded is-dark">
                  <span class="icon">
                      <i class="ai ai-arxiv"></i>
                  </span>
                  <span>arXiv</span>
                </a>
              </span>
              <!-- Video Link. -->
<!--               <span class="link-block">
                <a href=""
                   class="external-link button is-normal is-rounded is-dark">
                  <span class="icon">
                      <i class="fab fa-youtube"></i>
                  </span>
                  <span>Video</span>
                </a>
              </span>
 -->              <!-- Code Link. -->
              <span class="link-block">
                <a href="https://github.com/siyan-zhao/diffu-GRPO"
                   class="external-link button is-normal is-rounded is-dark">
                  <span class="icon">
                      <i class="fab fa-github"></i>
                  </span>
                  <span>Code</span>
                  </a>
              </span>
              <!-- Dataset Link. -->
              <!-- <span class="link-block">
                <a href="https://github.com/google/nerfies/releases/tag/0.1"
                   class="external-link button is-normal is-rounded is-dark">
                  <span class="icon">
                      <i class="far fa-images"></i>
                  </span>
                  <span>Data</span>
                  </a> -->
            </div>

          </div>
        </div>
      </div>
    </div>
  </div>
</section>

<section class="hero teaser">
  <div class="columns is-centered has-text-centered">
      <div class="column is-four-fifths">
        <h2 class="title is-3">Overview</h2>
          <div class="container is-max-desktop">
            <div class="container has-text-centered">
              <figure class="image is-50x-auto is-inline-block">
                <img src="./static/images/pull_fig.pdf" alt="teaser image" style="max-width: 80%; display: block; margin: 0 auto;">
                <h2 class="title is-3"></h2>
                <img src="./static/images/sota_comparison_dual_axis.pdf" alt="teaser image" style="max-width: 80%; display: block; margin: 0 auto;">
                <h2 class="title is-3"></h2>
                <h2 class="subtitle has-text-centered">
                  We propose d1, a two-stage framework that enhances the reasoning performance of pre-trained masked dLLMs by sequentially combining SFT and online RL. Using LLaDA-8B-Instruct as our base model, we show significant improvements with our method across four reasoning tasks, and against a suite of SOTA models.
              </h2>
              </figure>
            </div>
          </div>
        </div>
      </div>
</section>

<section class="hero teaser mt-6">
  <div class="container is-max-desktop">
    <div class="container has-text-centered">
      <figure class="image is-inline-block">
        <img src="./static/images/qualitative_example_1.png" alt="Centered Image" style="max-width: 70%; display: block; margin: 0 auto">
      </figure>
    </div>
  </div>
</section>


<section class="hero teaser mt-6">
  <div class="container is-max-desktop">
    <div class="container has-text-centered">
      <h2 class="title is-3"><i>diffu</i>-GRPO</h2>
      <figure class="item item-steve">
        <img src="./static/images/diffugrpo.pdf" alt="diffugrpo" style="max-width: 200%; display: block; margin: 0 auto;">
        <figure class="image is-inline-block">
          <img src="./static/images/algorithm.png" alt="Centered Image" style="max-width: 70%; display: block; margin: 0 auto">
        </figure>
        <h2 class="subtitle has-text-centered">
          The conventional GRPO algorithm does not directly generalize to dLLMs. The challenge lies in the computation of the log-likelihood of a completion at both, the token and sequence level. While this is straightforward for AR models...
      </h2>
      </figure>
    </div>
  </div>
</section>

<!-- <section class="hero teaser mt-6">
  <div class="container is-max-desktop">
    <div class="container has-text-centered">
      <figure class="image is-inline-block">
        <img src="./static/images/algorithm.png" alt="Centered Image" style="max-width: 70%; display: block; margin: 0 auto">
        <h2 class="subtitle has-text-centered">
          Thus, how to scale reasoning performance? To this end, we propose diffu-GRPO - a variation of GRPO for dLLMs. We make three simple changes to conventional GRPO, (i) Replace AR generation with iterative denoising steps, (ii) instead of directly calculating the log probability, we estimate it via monte-carlo sampling (since dLLMs optimize an ELBO) and (iii) while performing multiple update steps on a prompt, we enhance the learning signal by randomly masking the prompt in each iteration, leading to much faster convergence. While this would be OOD for AR models, it is in-distribution for dLLMs.
      </h2>
      </figure>
    </div>
  </div>
</section>
 -->
<section class="hero teaser mt-6">
  <div class="container is-max-desktop">
    <div class="container has-text-centered">
      <figure class="image is-inline-block">
        <img src="./static/images/masking_curves.pdf" alt="Centered Image" style="max-width: 70%; display: block; margin: 0 auto">
        <h2 class="subtitle has-text-centered">
          Our random masking strategy significantly speeds up GRPO convergence!
      </h2>
      </figure>
    </div>
  </div>
</section>

<section class="hero teaser mt-6">
  <div class="container is-max-desktop">
    <div class="container has-text-centered">
      <h2 class="title is-3">SFT on Distilled Reasoning Traces</h2>
        <figure class="image is-inline-block">
          <img src="./static/images/algorithm_sft.png" alt="Centered Image" style="max-width: 70%; display: block; margin: 0 auto">
        </figure>
        <h2 class="subtitle has-text-centered">
          We adapt the masked SFT algorithm proposed in LLaDA and use it to cold-start <i>diffu</i>-GRPO. Specifically, we perform SFT on distilled reasoning traces from thinking models (the s1K dataset) to imbibe dLLMs with the ability to self-correct.
      </h2>
    </div>
  </div>
</section>



<!-- <section class="hero teaser mt-6">
  <div class="container is-max-desktop">
    <div class="container has-text-centered">
      <figure class="image is-inline-block">
        <img src="./static/images/results.png" alt="Centered Image" style="max-width: 70%; display: block; margin: 0 auto">
        <h2 class="subtitle has-text-centered">
          Performance imporvements with diffu-GRPO.
      </h2>
      </figure>
    </div>
  </div>
</section>
 -->



<!-- <section class="hero is-light is-small">
  <div class="hero-body">
    <div class="container">
      <div id="results-carousel" class="carousel results-carousel">
        <div class="item item-steve">
          <video poster="" id="steve" autoplay controls muted loop playsinline height="100%">
            <source src="./static/videos/steve.mp4"
                    type="video/mp4">
          </video>
        </div>
        <div class="item item-chair-tp">
          <video poster="" id="chair-tp" autoplay controls muted loop playsinline height="100%">
            <source src="./static/videos/chair-tp.mp4"
                    type="video/mp4">
          </video>
        </div>
        <div class="item item-shiba">
          <video poster="" id="shiba" autoplay controls muted loop playsinline height="100%">
            <source src="./static/videos/shiba.mp4"
                    type="video/mp4">
          </video>
        </div>
        <div class="item item-fullbody">
          <video poster="" id="fullbody" autoplay controls muted loop playsinline height="100%">
            <source src="./static/videos/fullbody.mp4"
                    type="video/mp4">
          </video>
        </div>
        <div class="item item-blueshirt">
          <video poster="" id="blueshirt" autoplay controls muted loop playsinline height="100%">
            <source src="./static/videos/blueshirt.mp4"
                    type="video/mp4">
          </video>
        </div>
        <div class="item item-mask">
          <video poster="" id="mask" autoplay controls muted loop playsinline height="100%">
            <source src="./static/videos/mask.mp4"
                    type="video/mp4">
          </video>
        </div>
        <div class="item item-coffee">
          <video poster="" id="coffee" autoplay controls muted loop playsinline height="100%">
            <source src="./static/videos/coffee.mp4"
                    type="video/mp4">
          </video>
        </div>
        <div class="item item-toby">
          <video poster="" id="toby" autoplay controls muted loop playsinline height="100%">
            <source src="./static/videos/toby2.mp4"
                    type="video/mp4">
          </video>
        </div>
      </div>
    </div>
  </div>
</section> -->


<section class="section">
  <div class="container is-max-desktop">
    <!-- Abstract. -->
    <div class="columns is-centered has-text-centered">
      <div class="column is-four-fifths">
        <h2 class="title is-3">Abstract</h2>
        <div class="content has-text-justified">
          <p>
            Recent large language models (LLMs) have demonstrated strong reasoning capabilities that benefits from online reinforcement learning (RL). These capabilities have primarily been demonstrated within the left-to-right autoregressive (AR) generation paradigm. In contrast, non-autoregressive paradigms based on diffusion generate text in a coarse-to-fine manner. Although recent diffusion-based large language models (dLLMs) have achieved competitive language modeling performance compared to their AR counterparts, it remains unclear if dLLMs can also leverage recent advances in LLM reasoning.
          </p>
          <p>
            To this end, we propose <i>d1</i>, a framework to adapt pre-trained masked dLLMs into reasoning models via a combination of supervised fine-tuning (SFT) and RL.
          <p>
            Specifically, we develop and extend techniques to improve reasoning in pretrained dLLMs: (a) we utilize a masked SFT technique to distill knowledge and instill self-improvement behavior directly from existing datasets, and (b) we introduce a novel critic-free, policy-gradient based RL algorithm called <i>diffu</i>-GRPO. Through empirical studies, we investigate the performance of different post-training recipes on multiple mathematical and logical reasoning benchmarks. We find that d1 yields the best performance and significantly improves performance of a state-of-the-art dLLM. 
          </p>
        </div>
      </div>
    </div>
    <!--/ Abstract. -->

    <!-- Paper video. -->
  <!--   <div class="columns is-centered has-text-centered">
      <div class="column is-four-fifths">
        <h2 class="title is-3">Video</h2>
        <div class="publication-video">
          <iframe src=""
                  frameborder="0" allow="autoplay; encrypted-media" allowfullscreen></iframe>
        </div>
      </div>
    </div> -->
<!--     <div class="columns is-centered has-text-centered">
      <div class="column is-max-desktop">
        <h2 class="title is-3">Poster</h2>
        <figure class="image is-50x-auto is-inline-block">
          <img src="" alt="CLIPTrans poster">
        </figure>
      </div>
    </div>
 --><!--     <div class="Concurrent Works">
      <div class="column is-max-desktop">
        <h2 class="title is-3 has-text-centered">Concurrent Works</h2>
          <div class="content">
            <ol>
              <li><h4><a href="">Tackling Ambiguity with Images: Improved Multimodal Machine Translation and Contrastive Evaluation</a></h4></li>
              <li><h4><a href="">Beyond Triplet: Leveraging the Most Data for Multimodal Machine Translation</a></h4></li>
              
            </ol>
      </div>
    </div>
 -->
    <!--/ Paper video. -->
  </div>
</section>


<section class="section" id="BibTeX">
  <div class="container is-max-desktop content has-text-centered">
    <h2 class="title">BibTeX</h2>
    <pre><code>@inproceedings {zhaoandgupta2023d1,
    title={d1: Scaling Reasoning in Diffusion Large Language Models via Test-Time Inference},
    author={Zhao, Siyan and Gupta, Devaansh and Zheng, Qinqing and Grover, Aditya},
    booktitle={preprint},
    year={2025}
}
</code></pre>
  </div>
</section>

<footer class="footer">
  <div class="container">
    <div class="content has-text-centered">
      <a class="icon-link"
         href="https://arxiv.org/pdf/2308.15226.pdf">
        <i class="fas fa-file-pdf"></i>
      </a>
      <a class="icon-link" href="https://github.com/devaansh100" class="external-link" disabled>
        <i class="fab fa-github"></i>
      </a>
    </div>
    <div class="columns is-centered">
      <div class="column is-8">
        <div class="content">
          <p>
            This website is licensed under a <a rel="license"
                                                href="http://creativecommons.org/licenses/by-sa/4.0/">Creative
            Commons Attribution-ShareAlike 4.0 International License</a>.
          </p>
          <p>
            This means you are free to borrow the <a
              href="https://github.com/nerfies/nerfies.github.io">source code</a> of this website,
            we just ask that you link back to <a href="https://nerfies.github.io">this</a> page in the footer.
            Please remember to remove the analytics code included in the header of the website which
            you do not want on your website.
          </p>
        </div>
      </div>
    </div>
  </div>
</footer>

</body>
</html>
